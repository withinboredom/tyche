{
  "settings": {
    "defaultTool": "native"
  },
  "requires": [
    {
      "tool": "docker-compose",
      "supported": [
        {
          "platform": "osx",
          "version": "stable"
        }
      ]
    },
    {
      "tool": "docker",
      "supported": [
        {
          "platform": "osx",
          "version": "stable"
        }
      ]
    },
    {
      "tool": "npm",
      "supported": [
        {
          "platform": "osx",
          "version": "stable"
        }
      ]
    },
    {
      "tool": "nodejs",
      "supported": [
        {
          "platform": "osx",
          "version": "stable"
        }
      ]
    },
    {
      "tool": "tyche",
      "supported": [
        {
          "platform": "osx",
          "version": "stable"
        }
      ]
    }
  ],
  "projects": [
    {
      "name": "tyche-prep",
      "build": [
        {
          "tool": "docker-compose",
          "service": "tyche-prep"
        },
        {
          "tool": "native",
          "command": ["npm", "install"]
        }
      ],
      "clean": [
        {
          "tool": "docker-compose"
        },
        {
          "tool": "native",
          "command": ["rm","-rf","node_modules"]
        }
      ],
      "invalidate": [
        {
          "files": [
            "package.json"
          ]
        }
      ]
    },
    {
      "name": "tyche-cli",
      "build": [
        {
          "tool": "docker-compose",
          "service": "tyche-builder"
        },
        {
          "tool": "native",
          "command": ["npm", "run", "build-cli"]
        }
      ],
      "clean": [
        {
          "tool": "native",
          "command": ["rm","-rf","bin/*"]
        }
      ],
      "dependencies": [
        "tyche-prep"
      ],
      "repo": ".",
      "final": true
    }
  ],
  "actions": [
    {
      "name": "version-bump",
      "parameters": [
        {
          "required": true,
          "name": "version"
        }
      ],
      "run": {
        "tool": "docker-compose",
        "service": "bumper"
      }
    }
  ],
  "constraints": [
    {
      "name": "compile-on-push",
      "on": "git-push",
      "ensure": [
        {
          "object": "git.commit.sha",
          "matches": "projects.tyche-cli.build.commit.sha"
        }
      ]
    }
  ]
}
